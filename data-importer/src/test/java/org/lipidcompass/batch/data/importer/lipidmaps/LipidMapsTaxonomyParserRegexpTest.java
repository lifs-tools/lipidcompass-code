/* 
 * Copyright 2021 The LipidCompass Developers.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package org.lipidcompass.batch.data.importer.lipidmaps;

import java.util.Arrays;
import java.util.Collection;
import org.junit.runners.Parameterized;
import org.junit.runners.Parameterized.Parameter;
import org.junit.runners.Parameterized.Parameters;
import org.junit.Assert;
import org.junit.Test;
import org.junit.runner.RunWith;

/**
 *
 * @author nils.hoffmann
 */
@RunWith(Parameterized.class)
public class LipidMapsTaxonomyParserRegexpTest {

    public static final String[] VALUES = {
        "1-(1Z-alkenyl),2-acylglycerophosphates [GP1003]",
        "1-(1Z-alkenyl),2-acylglycerophosphocholines [GP0103]",
        "1-(1Z-alkenyl),2-acylglycerophosphoethanolamines [GP0203]",
        "1-(1Z-alkenyl),2-acylglycerophosphoglycerols [GP0403]",
        "1-(1Z-alkenyl),2-acylglycerophosphoinositols [GP0603]",
        "1-(1Z-alkenyl),2-acylglycerophosphoserines [GP0303]",
        "12-oxophytodienoic acid metabolites [FA0201]",
        "1-acyl,2-alkylglycerols [GL0207]",
        "1-acyl,2-alkylglycerophosphocholines [GP0108]",
        "1-acyl,2-alkylglycerophosphoethanolamines [GP0208]",
        "1-acyl,2-alkylglycerophosphoglycerols [GP0411]",
        "1-alkyl,2-acylglycerols [GL0202]",
        "1-alkyl,2-acylglycerophosphates [GP1002]",
        "1-alkyl,2-acylglycerophosphocholines [GP0102]",
        "1-alkyl,2-acylglycerophosphoethanolamines [GP0202]",
        "1-alkyl,2-acylglycerophosphoglycerols [GP0402]",
        "1-alkyl,2-acylglycerophosphoinositols [GP0602]",
        "1-alkyl,2-acylglycerophosphoserines [GP0302]",
        "1Z-alkenylacylglycerols [GL0204]",
        "1Z-alkenylglycerophosphates [GP1007]",
        "1Z-alkenylglycerophosphocholines [GP0107]",
        "1Z-alkenylglycerophosphoethanolamines [GP0207]",
        "1Z-alkenylglycerophosphoglycerols [GP0407]",
        "1Z-alkenylglycerophosphoinositols [GP0607]",
        "1Z-alkenylglycerophosphoserines [GP0307]",
        "4-Hydroxysphinganines (Phytosphingosines) [SP0103]",
        "Acidic glycosphingolipids [SP06]",
        "Acylaminosugar glycans [SL02]",
        "Acylaminosugars [SL01]",
        "Acylceramides [SP0204]",
        "Acyltrehaloses [SL03]",
        "Aflatoxins and related substances [PK10]",
        "Alkyl catechols and derivatives [PK1502]",
        "Alkyl hydroquinones and derivatives [PK1505]",
        "Alkyl phenols and derivatives [PK1501]",
        "Alkyl resorcinols and derivatives [PK1503]",
        "Amino fatty acids [FA0110]",
        "Amphoteric glycosphingolipids [SP08]",
        "Anacardic acids and derivatives [PK1504]",
        "Angucyclines [PK08]",
        "Annonaceae acetogenins [PK03]",
        "Ansamycins and related polyketides [PK05]",
        "Anthocyanidins [PK1201]",
        "Anthracenes and phenanthrenes [PK1304]",
        "Anthracyclinones [PK1305]",
        "Aromatic polyketides [PK13]",
        "Aurone flavonoids [PK1213]",
        "Bactoprenol diphosphates [PR0303]",
        "Bactoprenol monophosphates [PR0302]",
        "Bactoprenols [PR0301]",
        "Basic glycosphingolipids [SP07]",
        "Benzofuranoids [PK1310]",
        "Benzoisochromanquinones [PK1303]",
        "Benzopyranoids [PK1311]",
        "Biflavonoids and polyflavonoids [PK1204]",
        "Bile acids and derivatives [ST04]",
        "Branched fatty acids [FA0102]",
        "Brassinolides and derivatives [ST0114]",
        "Bufanolides and derivatives [ST0113]",
        "C10 isoprenoids (monoterpenes) [PR0102]",
        "C15 isoprenoids (sesquiterpenes) [PR0103]",
        "C18 steroids (estrogens) and derivatives [ST0201]",
        "C19 steroids (androgens) and derivatives [ST0202]",
        "C20 isoprenoids (diterpenes) [PR0104]",
        "C21 steroids (gluco/mineralocorticoids, progestogins) and derivatives [ST0203]",
        "C22 bile acids, alcohols, and derivatives [ST0405]",
        "C23 bile acids, alcohols, and derivatives [ST0406]",
        "C24 bile acids, alcohols, and derivatives [ST0401]",
        "C24-propyl sterols and derivatives [ST0105]",
        "C25 bile acids, alcohols, and derivatives [ST0407]",
        "C25 isoprenoids (sesterterpenes) [PR0105]",
        "C26 bile acids, alcohols, and derivatives [ST0402]",
        "C27 bile acids, alcohols, and derivatives [ST0403]",
        "C28 bile acids, alcohols, and derivatives [ST0404]",
        "C29 bile acids, alcohols, and derivatives [ST0408]",
        "C30 isoprenoids (triterpenes) [PR0106]",
        "C40 isoprenoids (tetraterpenes) [PR0107]",
        "C5 isoprenoids (hemiterpenes) [PR0101]",
        "Calysterols and cyclopropyl sidechain derivatives [ST0111]",
        "Carbocyclic fatty acids [FA0114]",
        "Cardanolides and derivatives [ST0112]",
        "CDP-diacylglycerols [GP1301]",
        "CDP-Glycerols [GP13]",
        "Ceramide 1-phosphates [SP0205]",
        "Ceramide phosphocholines (sphingomyelins) [SP0301]",
        "Ceramide phosphoethanolamines [SP0302]",
        "Ceramide phosphoinositols [SP0303]",
        "Ceramides [SP02]",
        "Chalcones and dihydrochalcones [PK1212]",
        "Cholesterol and derivatives [ST0101]",
        "Clavulones [FA0312]",
        "Coumestan flavonoids [PK1209]",
        "Cyano esters [FA0703]",
        "Cyano fatty acids [FA0111]",
        "Cycloartanols and derivatives [ST0110]",
        "Cytochalasins [PK11]",
        "Depsides and depsidones [PK1308]",
        "Diacylaminosugars [SL0102]",
        "Diacylglycerols [GL0201]",
        "Diacylglycerophosphates [GP1001]",
        "Diacylglycerophosphocholines [GP0101]",
        "Diacylglycerophosphoethanolamines [GP0201]",
        "Diacylglycerophosphoglycerols [GP0401]",
        "Diacylglycerophosphoglycerophosphates [GP0501]",
        "Diacylglycerophosphoglycerophosphodiradylglycerols [GP1201]",
        "Diacylglycerophosphoglycerophosphomonoradylglycerols [GP1202]",
        "Diacylglycerophosphoinositol bisphosphates [GP0801]",
        "Diacylglycerophosphoinositolglycans [GP1501]",
        "Diacylglycerophosphoinositol monophosphates [GP0701]",
        "Diacylglycerophosphoinositols [GP0601]",
        "Diacylglycerophosphoinositol trisphosphates [GP0901]",
        "Diacylglycerophosphomonoradylglycerols [GP0409]",
        "Diacylglycerophosphonocholines [GP1601]",
        "Diacylglycerophosphonoethanolamines [GP1701]",
        "Diacylglycerophosphoserines [GP0301]",
        "Diacylglyceropyrophosphates [GP1101]",
        "Diacylglycosylglycerophospholipids [GP1401]",
        "Dialkylglycerols [GL0203]",
        "Dialkylglycerophosphocholines [GP0104]",
        "Dialkylglycerophosphoethanolamines [GP0204]",
        "Dialkylglycerophosphoglycerols [GP0404]",
        "Dialkylglycerophosphoglycerophosphates [GP0504]",
        "Dialkylglycerophosphoglycerophosphodiradylglycerols [GP1212]",
        "Dialkylglycerophosphoinositols [GP0604]",
        "Dialkylglycosylglycerophospholipids [GP1407]",
        "Dibenzofurans, griseofulvins, dibenzopyrans and xanthones [PK1306]",
        "Dicarboxylic acids [FA0117]",
        "Di-glycerol tetraether glycans [GL0206]",
        "Di-glycerol tetraether phospholipids (caldarchaeols) [GP18]",
        "Di-glycerol tetraethers [GL0205]",
        "Dihydroflavonols [PK1215]",
        "Diphenyl ethers, biphenyls, dibenzyls and stilbenes [PK1309]",
        "Diphenylmethanes, acylphloroglucinols and benzophenones [PK1307]",
        "Diradylglycerols [GL02]",
        "Docosa-1,2-dioxolanes [FA0406]",
        "Docosanoids [FA04]",
        "Dolichol diphosphates [PR0309]",
        "Dolichol monophosphates [PR0308]",
        "Dolichols [PR0307]",
        "Eicosa-1,2-dioxolanes [FA0315]",
        "Eicosanoids [FA03]",
        "Epoxyeicosatrienoic acids [FA0308]",
        "Epoxy fatty acids [FA0107]",
        "Ergosterols and C24-methyl derivatives [ST0103]",
        "Estolides [GL0305]",
        "Fatty Acids and Conjugates [FA01]",
        "Fatty acyl adenylates [FA0708]",
        "Fatty acyl carnitines [FA0707]",
        "Fatty acyl CoAs [FA0705]",
        "Fatty acyl glycosides [FA13]",
        "Fatty acyl glycosides of mono- and disaccharides [FA1301]",
        "Fatty acyl homoserine lactones [FA0803]",
        "Fatty Acyls [FA]",
        "Fatty alcohols [FA05]",
        "Fatty aldehydes [FA06]",
        "Fatty amides [FA08]",
        "Fatty esters [FA07]",
        "Fatty ethers [FA10]",
        "Fatty nitriles [FA09]",
        "Flavanones [PK1214]",
        "Flavans, Flavanols and Leucoanthocyanidins [PK1202]",
        "Flavones and Flavonols [PK1211]",
        "Flavonoids [PK12]",
        "Furospirostanols and derivatives [ST0109]",
        "Furostanols and derivatives [ST0107]",
        "Galbeta1-3GlcNAcbeta1-3Galbeta1-4Glc- (Lacto series) [SP0504]",
        "Galbeta1-4GlcNAcbeta1-3Galbeta1-4Glc- (Neolacto series) [SP0505]",
        "Gal- (Gala series) [SP0509]",
        "GalNAcbeta1-3Galalpha1-3Galbeta1-4Glc- (Isoglobo series) [SP0506]",
        "GalNAcbeta1-3Galalpha1-4Galbeta1-4Glc- (Globo series) [SP0502]",
        "GalNAcbeta1-4Galbeta1-4Glc- (Ganglio series) [SP0503]",
        "GalNAcbeta1-4GlcNAcbeta1-3Manbeta1-4Glc- (Arthro series) [SP0508]",
        "Gangliosides [SP0601]",
        "GlcNAcbeta1-2Manalpha1-3Manbeta1-4Glc- (Mollu series) [SP0507]",
        "Glucuronides [ST0501]",
        "Glucuronosphingolipids [SP0603]",
        "Glycerolipids [GL]",
        "Glycerol-nonitol tetraether phospholipids [GP19]",
        "Glycerophosphates [GP10]",
        "Glycerophosphocholines [GP01]",
        "Glycerophosphoethanolamines [GP02]",
        "Glycerophosphoglycerols [GP04]",
        "Glycerophosphoglycerophosphates [GP05]",
        "Glycerophosphoglycerophosphoglycerols [GP12]",
        "Glycerophosphoinositol bisphosphates [GP08]",
        "Glycerophosphoinositolglycans [GP15]",
        "Glycerophosphoinositol monophosphates [GP07]",
        "Glycerophosphoinositols [GP06]",
        "Glycerophosphoinositol trisphosphates [GP09]",
        "Glycerophospholipids [GP]",
        "Glycerophosphonocholines [GP16]",
        "Glycerophosphonoethanolamines [GP17]",
        "Glycerophosphoserines [GP03]",
        "Glyceropyrophosphates [GP11]",
        "Glycine conjugates [ST0503]",
        "Glycosylalkylacylglycerols [GL0502]",
        "Glycosyldiacylglycerols [GL0501]",
        "Glycosyldialkylglycerols [GL0503]",
        "Glycosyldiradylglycerols [GL05]",
        "Glycosylglycerophospholipids [GP14]",
        "Glycosylmonoacylglycerols [GL0401]",
        "Glycosylmonoradylglycerols [GL04]",
        "Gorgosterols and derivatives [ST0106]",
        "Halogenated acetogenins [PK02]",
        "Halogenated fatty acids [FA0109]",
        "Hepoxilins [FA0309]",
        "Heterocyclic fatty acids [FA0115]",
        "Hexaacylaminosugars [SL0106]",
        "Hopanoids [PR04]",
        "Hydrocarbons [FA11]",
        "Hydroperoxy fatty acids [FA0104]",
        "Hydroxy fatty acids [FA0105]",
        "Hydroxy/hydroperoxyeicosapentaenoic acids [FA0307]",
        "Hydroxy/hydroperoxyeicosatetraenoic acids [FA0306]",
        "Hydroxy/hydroperoxyeicosatrienoic acids [FA0305]",
        "Isoflavans [PK1208]",
        "Isoflavonoids [PK1205]",
        "Isofurans [FA0313]",
        "Isoprenoids [PR01]",
        "Isoprostanes [FA0311]",
        "Jasmonic acids [FA0202]",
        "Lactones [FA0704]",
        "Leukotrienes [FA0302]",
        "Levuglandins [FA0310]",
        "Linear polyketides [PK01]",
        "Linear tetracyclines [PK07]",
        "Lipoxins [FA0304]",
        "Lysosphingomyelins and lysoglycosphingolipids [SP0106]",
        "Macrolides and lactone polyketides [PK04]",
        "Maresins [FA0405]",
        "Methoxy fatty acids [FA0108]",
        "Monoacylaminosugars [SL0101]",
        "Monoacylglycerols [GL0101]",
        "Monoacylglycerophosphates [GP1005]",
        "Monoacylglycerophosphocholines [GP0105]",
        "Monoacylglycerophosphoethanolamines [GP0205]",
        "Monoacylglycerophosphoglycerols [GP0405]",
        "Monoacylglycerophosphoglycerophosphomonoradylglycerols [GP1207]",
        "Monoacylglycerophosphoinositolglycans [GP1504]",
        "Monoacylglycerophosphoinositols [GP0605]",
        "Monoacylglycerophosphomonoradylglycerols [GP0410]",
        "Monoacylglycerophosphoserines [GP0305]",
        "Monoalkylglycerols [GL0102]",
        "Monoalkylglycerophosphates [GP1006]",
        "Monoalkylglycerophosphocholines [GP0106]",
        "Monoalkylglycerophosphoethanolamines [GP0206]",
        "Monoalkylglycerophosphoglycerols [GP0406]",
        "Monoalkylglycerophosphoinositols [GP0606]",
        "Monoalkylglycerophosphoserines [GP0306]",
        "Monocyclic aromatic polyketides [PK1301]",
        "Monoradylglycerols [GL01]",
        "Mycolic acids [FA0116]",
        "N-acyl-4-hydroxysphinganines (phytoceramides) [SP0203]",
        "N-acyl amines [FA0802]",
        "N-acyl ethanolamines (endocannabinoids) [FA0804]",
        "N-acylsphinganines (dihydroceramides) [SP0202]",
        "N-acylsphingosines (ceramides) [SP0201]",
        "Naphthalenes and naphthoquinones [PK1302]",
        "Neoflavonoids [PK1210]",
        "Neurofurans [FA0402]",
        "Neuroprostanes [FA0401]",
        "Neutral glycosphingolipids [SP05]",
        "Nitro fatty acids [FA0112]",
        "N-methylated sphingoid bases [SP0107]",
        "Non-ribosomal peptide/polyketide hybrids [PK14]",
        "Octadeca-1,2-dioxolanes [FA0205]",
        "Octadecanoids [FA02]",
        "Other acyl sugars [SL05]",
        "Other aromatic polyketides [PK1312]",
        "Other Docosanoids [FA0400]",
        "Other Eicosanoids [FA0300]",
        "Other Fatty Acyls [FA00]",
        "Other Flavonoids [PK1216]",
        "Other Glycerolipids [GL00]",
        "Other Glycerophospholipids [GP00]",
        "Other Neutral glycosphingolipids [SP0500]",
        "Other Octadecanoids [FA0200]",
        "Other Polyketides [PK00]",
        "Other Sphingolipids [SP00]",
        "Other Steroid conjugates [ST0505]",
        "Oxidized Cardiolipins [GP2003]",
        "Oxidized glycerophosphates [GP2006]",
        "Oxidized glycerophosphocholines [GP2001]",
        "Oxidized glycerophosphoethanolamines [GP2002]",
        "Oxidized glycerophosphoglycerols [GP2007]",
        "Oxidized glycerophosphoinositols [GP2005]",
        "Oxidized glycerophospholipids [GP20]",
        "Oxidized glycerophosphoserines [GP2004]",
        "Oxo fatty acids [FA0106]",
        "Oxygenated hydrocarbons [FA12]",
        "Pentaacylaminosugars [SL0105]",
        "Phenolic lipids [PK15]",
        "Phosphoglycosphingolipids [SP0604]",
        "Phosphonosphingolipids [SP04]",
        "Phosphosphingolipids [SP03]",
        "Phytofurans [FA0204]",
        "Phytoprenols [PR0304]",
        "Phytoprostanes [FA0203]",
        "Polyenes [PK06]",
        "Polyether antibiotics [PK09]",
        "Polyketides [PK]",
        "Polyprenols [PR03]",
        "Polyterpenes [PR0108]",
        "Prenol Lipids [PR]",
        "Primary amides [FA0801]",
        "Proanthocyanidins [PK1203]",
        "Prostaglandins [FA0301]",
        "Protectins [FA0404]",
        "Pterocarpans [PK1207]",
        "Quinones and hydroquinones [PR02]",
        "Resolvin Ds [FA0403]",
        "Resolvin Es [FA0314]",
        "Retinoids [PR0109]",
        "Rhamnolipids [FA1303]",
        "Rotenoid flavonoids [PK1206]",
        "Saccharolipids [SL]",
        "Secosteroids [ST03]",
        "Simple Glc series [SP0501]",
        "Solanidines and alkaloid derivatives [ST0115]",
        "Sophorolipids [FA1302]",
        "Sphing-4-enines (Sphingosines) [SP0101]",
        "Sphinganines [SP0102]",
        "Sphingoid base 1-phosphates [SP0105]",
        "Sphingoid base analogs [SP0108]",
        "Sphingoid base homologs and variants [SP0104]",
        "Sphingoid bases [SP01]",
        "Sphingolipids [SP]",
        "Spirostanols and derivatives [ST0108]",
        "Steroid conjugates [ST05]",
        "Steroids [ST02]",
        "Sterol Lipids [ST]",
        "Sterols [ST01]",
        "Steryl esters [ST0102]",
        "Stigmasterols and C24-ethyl derivatives [ST0104]",
        "Straight chain fatty acids [FA0101]",
        "Sulfates [ST0502]",
        "Sulfoglycosphingolipids (sulfatides) [SP0602]",
        "Taurine conjugates [ST0504]",
        "Tetraacylaminosugars [SL0104]",
        "Thia fatty acids [FA0113]",
        "Thromboxanes [FA0303]",
        "Triacylglycerols [GL0301]",
        "Triradylglycerols [GL03]",
        "Ubiquinones [PR0201]",
        "Unsaturated fatty acids [FA0103]",
        "Vitamin D2 and derivatives [ST0301]",
        "Vitamin D3 and derivatives [ST0302]",
        "Vitamin D4 and derivatives [ST0303]",
        "Vitamin D5 and derivatives [ST0304]",
        "Vitamin D6 and derivatives [ST0305]",
        "Vitamin D7 and derivatives [ST0306]",
        "Vitamin E [PR0202]",
        "Vitamin K [PR0203]",
        "Wax diesters [FA0702]",
        "Wax monoesters [FA0701]",
        "Withanolides and derivatives [ST0116]"
    };

    @Parameters(
        name = "{index}: parsing / splitting of ''{0}''.")
    public static Collection<String> data() {
        return Arrays.asList(VALUES);
    }
    
    @Parameter(0)
    public String taxString;
    
    @Test
    public void testRegexp() {
        LipidMapsIAtomContainerToLipidProcessor processor = new LipidMapsIAtomContainerToLipidProcessor();
        String[] split = processor.splitLmNameAndAbbr(taxString, "LEVEL", "LVL");
        Assert.assertEquals(2, split.length);
        Assert.assertFalse(split[0].startsWith("UNDEFINED-"));
        Assert.assertFalse(split[1].startsWith("["));
        Assert.assertFalse(split[1].endsWith("]"));
    }

}
